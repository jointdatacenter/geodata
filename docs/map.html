<!DOCTYPE html>
<meta charset="utf-8">

<link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet">

<!-- Create an element where the map will take place -->
<div id="map-container" style="width: 100%; margin: 0 auto; position: relative; text-align: center;">
    <object id="svg-object" data="map_unhcr.svg" type="image/svg+xml" width="100%" height="600">
        <img src="map_unhcr.svg" alt="World Map" width="100%" height="600">
    </object>

    <!-- Legend -->
    <svg id="legend" style="position: absolute; top: 30px; right: 20px; width: 180px; height: 75px;">
        <rect x="0" y="0" width="18" height="18" fill="#00B398"></rect>
        <text x="25" y="13" font-family="Lato, sans-serif" font-size="14px" alignment-baseline="middle">Ongoing</text>

        <rect x="0" y="25" width="18" height="18" fill="#027B68"></rect>
        <text x="25" y="38" font-family="Lato, sans-serif" font-size="14px" alignment-baseline="middle">Ongoing & Completed</text>

        <rect x="0" y="50" width="18" height="18" fill="#8EBEFF"></rect>
        <text x="25" y="63" font-family="Lato, sans-serif" font-size="14px" alignment-baseline="middle">Completed</text>
    </svg>
</div>

<script src="countries_data.js"></script>
<script>
// Define color variables
const COLORS = {
    ongoing: "#00B398",
    completed: "#8EBEFF",
    both: "#027B68",
    default: "#E6E6E6"
};

const countryStatus = {};
countryCategories.ongoing.forEach(c => countryStatus[c] = "ongoing");
countryCategories.completed.forEach(c => countryStatus[c] = "completed");
countryCategories.both.forEach(c => countryStatus[c] = "both");

// Wait for SVG to load
document.getElementById('svg-object').addEventListener('load', function() {
    const svgDoc = this.contentDocument;
    const paths = svgDoc.querySelectorAll('path');

    paths.forEach(path => {
        // Get country code from the id attribute (now properly set)
        const countryCode = path.getAttribute('id');
        const countryName = path.getAttribute('data-name');

        if (countryCode && countryStatus[countryCode]) {
            path.style.fill = COLORS[countryStatus[countryCode]];
        } else {
            path.style.fill = COLORS.default;
        }

        // Add stroke for better visibility
        path.style.stroke = '#f0f0f0';
        path.style.strokeWidth = '0.2px';

        // Add hover effects with country name tooltip
        path.addEventListener('mouseenter', function(e) {
            // Create tooltip
            const tooltip = document.createElement('div');
            tooltip.id = 'country-tooltip';
            tooltip.textContent = countryName || countryCode;
            tooltip.style.cssText = `
                position: fixed;
                background: white;
                border: 1px solid #ccc;
                padding: 5px 10px;
                border-radius: 4px;
                font-family: Lato, sans-serif;
                font-size: 14px;
                color: black;
                pointer-events: none;
                z-index: 1000;
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            `;
            document.body.appendChild(tooltip);
        });

        path.addEventListener('mousemove', function(e) {
            const tooltip = document.getElementById('country-tooltip');
            if (tooltip) {
                tooltip.style.left = (e.clientX + 10) + 'px';
                tooltip.style.top = (e.clientY - 30) + 'px';
            }
        });

        path.addEventListener('mouseleave', function(e) {
            const tooltip = document.getElementById('country-tooltip');
            if (tooltip) {
                tooltip.remove();
            }
        });
    });
});
</script>

</body>
</html>